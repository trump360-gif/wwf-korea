# 기부 플로우 상세 명세

**PRD 참조:** 섹션 4, 6.8, 7, 8.3

---

## 스텝 흐름

```
스텝 1 (금액 설정)
    ↓
스텝 2 (추가 참여?)
    ├── "네" → 스텝 2-1 (카테고리 선택)
    │              ↓
    └── "아니오" → 스텝 3 (결제 정보)
                    ↓
               /donate/complete
```

---

## 예외 처리 (PRD 섹션 4.6)

### 금액 입력 검증

| 조건 | 처리 |
|------|------|
| 금액 미입력/0원 | "다음" 버튼 비활성화, "후원 금액을 선택해주세요" |
| 최소 금액 미달 (< 1,000원) | "최소 후원 금액은 1,000원입니다" |
| 최대 금액 초과 | 일시: 1억원, 월정기: 1,000만원 |
| 숫자 외 입력 | input type=number + 한글/특수문자 필터 |

### 필수 필드 검증 (스텝 3)

| 필드 | 규칙 | 에러 메시지 |
|------|------|------------|
| 이름 | 2자 이상, 공백만 불가 | "이름을 입력해주세요" |
| 이메일 | 이메일 형식 | "올바른 이메일 주소를 입력해주세요" |
| 연락처 | 숫자 10~11자리, 자동 하이픈 | "연락처를 입력해주세요" |
| 결제 수단 | 1개 이상 선택 | "결제 수단을 선택해주세요" |

- "후원하기" 버튼: 모든 필드 유효 시만 활성화
- 인라인 검증 (blur 시 즉시) + 폼 제출 시 재검증

### 모달 동작 정책

| 상황 | 동작 |
|------|------|
| X 버튼 / 오버레이 클릭 | 스텝 1: 즉시 닫기 / 스텝 2+: 확인 다이얼로그 |
| 브라우저 뒤로가기 | 모달만 닫기 (history.pushState) |
| 닫기 후 재진입 | 상태 초기화 |
| 새로고침 | 상태 유실, 모달 닫힌 상태 |

### 감사 페이지 보호

- `/donate/complete` 직접 접근 (상태 없음) → `/` 리다이렉트
- sessionStorage 1회성 백업 → 새로고침 시 감사 메시지 유지

---

## 모바일 기부 모달 (PRD 섹션 6.8)

### 전환 규칙
- 768px 미만: 풀스크린 바텀시트
- 768px 이상: 센터 모달 (max-width: 520px)

### 모바일 UX
- 금액 프리셋: 2x2 그리드 (터치 타겟 48px+)
- 카테고리 카드: 1열 리스트
- 하단 버튼: 고정 (safe-area-inset-bottom)
- 프로그레스 바: 상단 고정, 스텝 번호 제거
- 닫기: X 대신 ← 뒤로 텍스트
- 키보드: scrollIntoView 처리
